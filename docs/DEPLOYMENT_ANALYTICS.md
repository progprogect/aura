# üöÄ –î–µ–ø–ª–æ–π —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω–∞ production

**–î–∞—Ç–∞:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** MVP

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

1. ‚úÖ –ö–æ–¥ –∑–∞–ª–∏—Ç –≤ `main` –≤–µ—Ç–∫—É
2. ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
3. ‚è≥ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

---

## üìã –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ production

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Railway CLI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î —á–µ—Ä–µ–∑ Railway CLI
railway connect

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
psql $DATABASE_URL -f prisma/migrations/apply_to_production.sql
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Railway Dashboard

1. –ó–∞–π—Ç–∏ –≤ Railway Dashboard
2. –û—Ç–∫—Ä—ã—Ç—å PostgreSQL service
3. –ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª "Query"
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `prisma/migrations/apply_to_production.sql`
5. –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Prisma Migrate (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

```bash
DATABASE_URL="postgresql://postgres:AEXabgipqvhbLSwunyuZfLBgwtZsgHjg@hopper.proxy.rlwy.net:40277/railway" \
npx prisma migrate deploy
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `SpecialistAnalyticsDaily` —Å–æ–∑–¥–∞–Ω–∞
2. ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
3. ‚úÖ –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω
4. ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ

**SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
SELECT EXISTS (
  SELECT FROM information_schema.tables 
  WHERE table_schema = 'public' 
  AND table_name = 'SpecialistAnalyticsDaily'
);

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã
\d "SpecialistAnalyticsDaily"

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤
SELECT indexname, indexdef 
FROM pg_indexes 
WHERE tablename = 'SpecialistAnalyticsDaily';
```

---

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è production —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:

```
REDIS_PUBLIC_URL=redis://default:VwgtfvXFMAnuMOItGfwKMSZSWODgwVVs@turntable.proxy.rlwy.net:27179
```

–∏–ª–∏

```
REDIS_URL=redis://default:VwgtfvXFMAnuMOItGfwKMSZSWODgwVVs@turntable.proxy.rlwy.net:27179
```

---

## ‚úÖ –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –¥–µ–ø–ª–æ—è –∫–æ–¥–∞:

1. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–Ω–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ (lazy aggregation)
3. –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/profile/analytics` –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

---

---

## ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞

**–î–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞ production –ë–î

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `SpecialistAnalyticsDaily` —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –í—Å–µ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞ production

---

## üîç –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-01-27

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `SpecialistAnalyticsDaily` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å—Ö–µ–º–µ `public`
- ‚úÖ –í—Å–µ 14 –∫–æ–ª–æ–Ω–æ–∫ —Å–æ–∑–¥–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ 4 –∏–Ω–¥–µ–∫—Å–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã:
  - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á `SpecialistAnalyticsDaily_pkey`
  - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å `SpecialistAnalyticsDaily_specialistId_date_key` (specialistId, date)
  - –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å `SpecialistAnalyticsDaily_specialistId_date_idx` (specialistId, date)
  - –ò–Ω–¥–µ–∫—Å –ø–æ –¥–∞—Ç–µ `SpecialistAnalyticsDaily_date_idx` (date)
- ‚úÖ –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á `SpecialistAnalyticsDaily_specialistId_fkey` –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
  - –°–≤—è–∑—å —Å `SpecialistProfile(id)`
  - `ON UPDATE CASCADE`
  - `ON DELETE CASCADE`
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é (0 –∑–∞–ø–∏—Å–µ–π ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ.

