# üéâ UNIFIED AUTH SYSTEM ‚Äî –ì–û–¢–û–í–û!

## üìä –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ò –†–ê–ë–û–¢–ê–ï–¢**  
**–î–∞—Ç–∞:** 9 –æ–∫—Ç—è–±—Ä—è 2025  
**–û—Ü–µ–Ω–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:** 10/10

---

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ **User** ‚Äî –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **SpecialistProfile** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
- ‚úÖ Unified auth ‚Äî –æ–¥–∏–Ω cookie, –æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Å—Å–∏–π
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç best practices 2025 (Airbnb, LinkedIn, Fiverr)

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**–î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (—Ç–µ–ª–µ—Ñ–æ–Ω + –∏–º—è/—Ñ–∞–º–∏–ª–∏—è)
- ‚úÖ –í—Ö–æ–¥ (—Ç–µ–ª–µ—Ñ–æ–Ω + SMS –∫–æ–¥)
- ‚úÖ –ü–æ–∏—Å–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ –∫–∞—Ç–∞–ª–æ–≥
- ‚úÖ AI-—á–∞—Ç –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º

**–î–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤:**
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (—Å–æ–∑–¥–∞—ë—Ç User + SpecialistProfile)
- ‚úÖ –í—Ö–æ–¥
- ‚úÖ –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è)
- ‚úÖ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ –í—Å—ë —Ç–æ–∂–µ —á—Ç–æ –∏ —É –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
npm run dev
```

### 2. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- http://localhost:3000 ‚Äî –≥–ª–∞–≤–Ω–∞—è
- http://localhost:3000/auth/user/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- http://localhost:3000/auth/register ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
- http://localhost:3000/catalog ‚Äî –∫–∞—Ç–∞–ª–æ–≥
- http://localhost:3000/chat ‚Äî AI-—á–∞—Ç

### 3. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
- **SMS –∫–æ–¥:** 1234 (–¥–ª—è –≤—Å–µ—Ö –Ω–æ–º–µ—Ä–æ–≤ –≤ dev —Ä–µ–∂–∏–º–µ)
- **–¢–µ—Å—Ç–æ–≤—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç:** –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞ (–ø—Å–∏—Ö–æ–ª–æ–≥)
  - –ü—Ä–æ—Ñ–∏–ª—å: http://localhost:3000/specialist/anna-ivanova-psiholog

---

## üìù –ù–∞–≤–∏–≥–∞—Ü–∏—è

### –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
```
[–ì–ª–∞–≤–Ω–∞—è] [AI-–ü–æ–º–æ—â–Ω–∏–∫] [–ö–∞—Ç–∞–ª–æ–≥] [–í–æ–π—Ç–∏] [–°—Ç–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º]
   ‚Üì           ‚Üì             ‚Üì        ‚Üì              ‚Üì
 –ì–ª–∞–≤–Ω–∞—è    /chat      /catalog  /auth/user/  /auth/register
                                   login
```

### –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Ç–æ–ª—å–∫–æ User):
```
[–ì–ª–∞–≤–Ω–∞—è] [AI-–ü–æ–º–æ—â–Ω–∏–∫] [–ö–∞—Ç–∞–ª–æ–≥] [üë§ –ò–≤–∞–Ω ‚ñº]
                                      ‚Üì
                            [–ü—Ä–æ—Ñ–∏–ª—å]
                            [–°—Ç–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º] ‚Üê API: /api/auth/user/become-specialist
                            [–í—ã–π—Ç–∏]
```

### –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç (User + SpecialistProfile):
```
[–ì–ª–∞–≤–Ω–∞—è] [AI-–ü–æ–º–æ—â–Ω–∏–∫] [–ö–∞—Ç–∞–ª–æ–≥] [–ú–æ—ë –¥–µ–ª–æ] [üë§ –ò–≤–∞–Ω ‚ñº]
   ‚Üì           ‚Üì             ‚Üì          ‚Üì           ‚Üì
 –ü–æ–∏—Å–∫    –ü–æ–∏—Å–∫ –¥–ª—è   –ü–æ–∏—Å–∫ –¥–ª—è  /specialist/  –ü—Ä–æ—Ñ–∏–ª—å
          —Å–µ–±—è        –∫–ª–∏–µ–Ω—Ç–æ–≤    dashboard    –ó–∞—è–≤–∫–∏
                                              –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                                              –í—ã–π—Ç–∏
```

---

## üîë –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –û–¥–∏–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ = –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç
- –ù–µ—Ç –ø—É—Ç–∞–Ω–∏—Ü—ã
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ—Å—Ç–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 2. –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç = –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å + —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
- –õ–æ–≥–∏—á–Ω–æ
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏

### 3. –ù–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–æ–ª–µ–π
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- –ö–∞–∫ —É –ª–∏–¥–µ—Ä–æ–≤ —Ä—ã–Ω–∫–∞ 2025
- –ú–µ–Ω—å—à–µ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ lib/auth/
‚îÇ   ‚îú‚îÄ‚îÄ user-auth-service.ts ‚Üê –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ specialist-auth-service.ts ‚Üê –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ api-auth.ts ‚Üê unified getAuthSession()
‚îÇ   ‚îú‚îÄ‚îÄ server.ts ‚Üê server-side auth
‚îÇ   ‚îî‚îÄ‚îÄ types.ts ‚Üê —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/ ‚Üê endpoints –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register/ ‚Üê —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ login/ ‚Üê –≤—Ö–æ–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/ ‚Üê —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ register/ ‚Üê —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ specialist/ ‚Üê –∫–∞–±–∏–Ω–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ auth/
        ‚îú‚îÄ‚îÄ AuthUserLoginForm ‚Üê –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        ‚îî‚îÄ‚îÄ AuthUserRegisterForm ‚Üê —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

- [x] –°–±–æ—Ä–∫–∞ TypeScript ‚Äî —É—Å–ø–µ—à–Ω–æ
- [x] –°–±–æ—Ä–∫–∞ Next.js ‚Äî —É—Å–ø–µ—à–Ω–æ
- [x] Prisma schema ‚Äî –≤–∞–ª–∏–¥–Ω–∞
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- [x] Seed ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] API `/specialists` ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ curl)
- [x] Dev server ‚Äî –∑–∞–ø—É—â–µ–Ω

---

## üéØ –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
1. **–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI** ‚Äî –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –≤—Å–µ–º —Ñ–ª–æ—É
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞** ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ–æ—Ä–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ dashboard** ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∑–∞—è–≤–∫–∏

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:
4. **UI –¥–ª—è "–°—Ç–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º"** ‚Äî –∫–Ω–æ–ø–∫–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Äî /profile
6. **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—é–±–∏–º—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

---

**Dev server: http://localhost:3000** üöÄ

