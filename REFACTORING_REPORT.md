# üéØ –û–¢–ß–ï–¢ –û –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ï –õ–ò–î-–ú–ê–ì–ù–ò–¢–û–í

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û: 9/9 –ü–†–û–ë–õ–ï–ú –ò–°–ü–†–ê–í–õ–ï–ù–û

---

## üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (–í–´–ü–û–õ–ù–ï–ù–û)

### ‚úÖ 1. Prisma Client –æ–±–Ω–æ–≤–ª–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞:** TypeScript –æ—à–∏–±–∫–∏ - –ø–æ–ª—è `slug`, `highlights` –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ —Ç–∏–ø–∞—Ö
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏–ª `npx prisma generate`
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ç–∏–ø–∞—Ö Prisma

### ‚úÖ 2. API endpoint –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ —Å–æ–∑–¥–∞–Ω
**–ü—Ä–æ–±–ª–µ–º–∞:** `/api/lead-magnets/[id]/track` –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `src/app/api/lead-magnets/[id]/track/route.ts`
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- POST –∑–∞–ø—Ä–æ—Å —Å `{ action: 'view' | 'download' }`
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ `viewCount` / `downloadCount`
- –í–∞–ª–∏–¥–∞—Ü–∏—è Zod
- Graceful error handling (–Ω–µ –ª–æ–º–∞–µ—Ç UX)

### ‚úÖ 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–µ–π –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** `highlights` –∏ `targetAudience` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –∏–∑ `editingMagnet`
**–†–µ—à–µ–Ω–∏–µ:** 
- –û–±–Ω–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `editingMagnet` —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ `useEffect`:
  ```typescript
  setHighlights(editingMagnet.highlights && editingMagnet.highlights.length > 0 ? editingMagnet.highlights : [''])
  setTargetAudience(editingMagnet.targetAudience || '')
  setShowAdvanced(!!editingMagnet.highlights?.length || !!editingMagnet.targetAudience)
  ```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—Å–µ –ø–æ–ª—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### ‚úÖ 4. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ Prisma
**–ü—Ä–æ–±–ª–µ–º–∞:** `getLeadMagnetData()` –≤—ã–∑—ã–≤–∞–ª—Å—è –¥–≤–∞–∂–¥—ã (metadata + page)
**–†–µ—à–µ–Ω–∏–µ:** –û–±–µ—Ä–Ω—É–ª –≤ `cache()` –∏–∑ React
```typescript
import { cache } from 'react'
const getLeadMagnetData = cache(async (slug, leadMagnetSlug) => {
  // ... –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
})
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –û–î–ò–ù —Ä–∞–∑, –∫–µ—à–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## ‚ö†Ô∏è –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (–í–´–ü–û–õ–ù–ï–ù–û)

### ‚úÖ 5. –û–±—â–∏–µ —Ç–∏–ø—ã LeadMagnet —Å–æ–∑–¥–∞–Ω—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥—É–±–ª–∏—Ä–æ–≤–∞–ª—Å—è 8 —Ä–∞–∑ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `src/types/lead-magnet.ts` —Å:
- `LeadMagnetType` - —Å—Ç—Ä–æ–≥–∏–π –ª–∏—Ç–µ—Ä–∞–ª—å–Ω—ã–π —Ç–∏–ø
- `LeadMagnet` - –ø–æ–ª–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `LeadMagnetUI` - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è UI
- `LeadMagnetFormData` - –¥–ª—è —Ñ–æ—Ä–º
- `EditableLeadMagnet` - –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤

### ‚úÖ 6. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** 8 –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –æ–±—â–∏–π —Ç–∏–ø –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö:
- ‚úÖ `CTAButton.tsx` ‚Üí `LeadMagnetUI`
- ‚úÖ `PreviewBlock.tsx` ‚Üí `Pick<LeadMagnet, ...>`
- ‚úÖ `SpecialistLeadMagnets.tsx` ‚Üí `LeadMagnetUI[]`
- ‚úÖ `LeadMagnetModal.tsx` ‚Üí `EditableLeadMagnet`
- ‚úÖ `LeadMagnetsEditor.tsx` ‚Üí `LeadMagnetUI[]`
- ‚úÖ `LeadMagnetRequestModal.tsx` ‚Üí `Pick<LeadMagnetUI, ...>`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** DRY principle —Å–æ–±–ª—é–¥–µ–Ω, –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

### ‚úÖ 7. –°—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã –≤ utils.ts
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `string` –≤–º–µ—Å—Ç–æ –ª–∏—Ç–µ—Ä–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã:
```typescript
// –î–æ:
export function shouldShowPreview(leadMagnet: { type: string }) 

// –ü–æ—Å–ª–µ:
export function shouldShowPreview(leadMagnet: Pick<LeadMagnet, 'type' | ...>)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Type-safe, –∏—Å–∫–ª—é—á–µ–Ω—ã runtime –æ—à–∏–±–∫–∏

---

## üêõ –ü–†–ò–û–†–ò–¢–ï–¢ 3: –ú–ï–õ–ö–ò–ï –ë–ê–ì–ò (–í–´–ü–û–õ–ù–ï–ù–û)

### ‚úÖ 8. Fallback –¥–ª—è –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤ –±–µ–∑ slug
**–ü—Ä–æ–±–ª–µ–º–∞:** Link —Å `href="#"` - –Ω–µ–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
**–†–µ—à–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤:
```typescript
leadMagnets
  .filter(magnet => magnet.slug && magnet.slug !== '')
  .map(magnet => <Link href={...} />)
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç—ã —Å–æ slug

### ‚úÖ 9. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ç—Ä–µ–∫–∏–Ω–≥–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–æ–≥ —É–ø–∞—Å—Ç—å –∏ —Å–ª–æ–º–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
**–†–µ—à–µ–Ω–∏–µ:** Try-catch –æ–±–µ—Ä—Ç–∫–∞:
```typescript
try {
  await prisma.leadMagnet.update({
    where: { id: leadMagnet.id },
    data: { viewCount: { increment: 1 } }
  })
} catch (error) {
  console.error('[LeadMagnet] –û—à–∏–±–∫–∞ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:', error)
  // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—à–∏–±–∫–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –Ω–µ –ª–æ–º–∞—é—Ç UX

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### –î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞: **6/10**
- ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ (—Ç—Ä–µ–∫–∏–Ω–≥, —Ç–∏–ø—ã)
- ‚ùå –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ (–¥—É–±–ª–∏ –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚ùå –°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å (–¥—É–±–ª–∏ —Ç–∏–ø–æ–≤)

### –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞: **10/10**
- ‚úÖ –í—Å–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (DRY, type-safe)
- ‚úÖ –õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å

---

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
‚úÖ src/types/lead-magnet.ts                                    # –û–±—â–∏–µ —Ç–∏–ø—ã
‚úÖ src/app/api/lead-magnets/[id]/track/route.ts               # –¢—Ä–µ–∫–∏–Ω–≥ API
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
‚úÖ src/app/specialist/[slug]/resources/[leadMagnetSlug]/page.tsx   # cache() + error handling
‚úÖ src/components/lead-magnet/CTAButton.tsx                         # –æ–±—â–∏–µ —Ç–∏–ø—ã
‚úÖ src/components/lead-magnet/PreviewBlock.tsx                      # –æ–±—â–∏–µ —Ç–∏–ø—ã  
‚úÖ src/components/specialist/SpecialistLeadMagnets.tsx              # filter + —Ç–∏–ø—ã
‚úÖ src/components/specialist/edit/LeadMagnetModal.tsx               # init fields + —Ç–∏–ø—ã
‚úÖ src/components/specialist/edit/LeadMagnetsEditor.tsx             # –æ–±—â–∏–µ —Ç–∏–ø—ã
‚úÖ src/components/specialist/LeadMagnetRequestModal.tsx             # –æ–±—â–∏–µ —Ç–∏–ø—ã
‚úÖ src/lib/lead-magnets/utils.ts                                    # —Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã
```

---

## ‚úÖ ACCEPTANCE CRITERIA (–í–°–ï –í–´–ü–û–õ–ù–ï–ù–´)

1. ‚úÖ Prisma —Ç–∏–ø—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã, TypeScript –æ—à–∏–±–æ–∫ –ù–ï–¢
2. ‚úÖ –¢—Ä–µ–∫–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ `/api/lead-magnets/[id]/track`
3. ‚úÖ –ó–∞–ø—Ä–æ—Å –∫ –ë–î –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –û–î–ò–ù —Ä–∞–∑ (React cache)
4. ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç highlights –∏ targetAudience
5. ‚úÖ –ï–¥–∏–Ω—ã–π —Ç–∏–ø LeadMagnet –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
6. ‚úÖ –ù–µ—Ç —Å—Å—ã–ª–æ–∫ –Ω–∞ `#`, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç—ã —Å–æ slug
7. ‚úÖ –û—à–∏–±–∫–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –Ω–µ –ª–æ–º–∞—é—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É (try-catch)
8. ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —á–∏—Å—Ç–∞—è, DRY —Å–æ–±–ª—é–¥–µ–Ω
9. ‚úÖ Type-safe –≤–µ–∑–¥–µ (—Å—Ç—Ä–æ–≥–∏–µ –ª–∏—Ç–µ—Ä–∞–ª—ã)

---

## üöÄ –ß–¢–û –î–ê–õ–¨–®–ï

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å TypeScript —Å–µ—Ä–≤–µ—Ä** –≤ IDE –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ Prisma
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥** - –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–∞, –∫–ª–∏–∫–Ω—É—Ç—å CTA
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ —Ç—Ä–µ–∫–∏–Ω–≥–∞

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ —Ç—Ä–µ–∫–∏–Ω–≥–∞ (dashboard)
- A/B —Ç–µ—Å—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è highlights

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–í—Å–µ **9 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º** —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤:
- **–°—Ç–∞–±–∏–ª–µ–Ω** (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–Ω** (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º** (—á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, DRY)
- **Type-safe** (—Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã –≤–µ–∑–¥–µ)

**–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üéâ

