// Prisma schema –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========================================
// –û–°–ù–û–í–ù–ê–Ø –ú–û–î–ï–õ–¨ –°–ü–ï–¶–ò–ê–õ–ò–°–¢–ê
// ========================================

model Specialist {
  id              String   @id @default(cuid())
  
  // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è)
  firstName       String
  lastName        String
  avatar          String?
  slug            String   @unique
  
  // –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
  category        String                    // "psychology" | "fitness" | "nutrition" | "massage" | "wellness" | "coaching" | "medicine" | "other"
  specializations String[]                  // –ì–∏–±–∫–∏–µ —Ç–µ–≥–∏: ["–ö–ü–¢-—Ç–µ—Ä–∞–ø–µ–≤—Ç", "–¢—Ä–µ–Ω–µ—Ä –ø–æ –π–æ–≥–µ", "–ù—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥"]
  
  // –û–ø–∏—Å–∞–Ω–∏–µ
  tagline         String?                   // –ö—Ä–∞—Ç–∫–∏–π —Å–ª–æ–≥–∞–Ω (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
  about           String                    // –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∞
  
  // –õ–æ–∫–∞—Ü–∏—è –∏ —Ñ–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã
  city            String?
  country         String   @default("–†–æ—Å—Å–∏—è")
  workFormats     String[]                  // ["online", "offline", "hybrid"]
  
  // –û–ø—ã—Ç
  yearsOfPractice Int?
  
  // –ö–æ–Ω—Ç–∞–∫—Ç—ã
  phone           String?
  email           String?
  telegram        String?
  whatsapp        String?
  instagram       String?
  website         String?
  
  // –°—Ç–æ–∏–º–æ—Å—Ç—å
  priceFrom       Int?                      // –¶–µ–Ω–∞ –æ—Ç (–≤ –∫–æ–ø–µ–π–∫–∞—Ö –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏)
  priceTo         Int?                      // –¶–µ–Ω–∞ –¥–æ
  currency        String   @default("RUB")
  priceDescription String?                  // "–∑–∞ —Å–µ—Å—Å–∏—é 60 –º–∏–Ω" –∏–ª–∏ "–∑–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É 3 –º–µ—Å—è—Ü–∞"
  
  // –ì–∏–±–∫–∏–µ –ø–æ–ª—è (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
  customFields    Json?
  // –ü—Ä–∏–º–µ—Ä—ã:
  // psychology: { "methods": ["–ö–ü–¢", "–ú–∞–π–Ω–¥—Ñ—É–ª–Ω–µ—Å—Å"], "worksWith": ["–¢—Ä–µ–≤–æ–≥–∞", "–î–µ–ø—Ä–µ—Å—Å–∏—è"], "sessionFormats": ["individual", "couples"], "sessionDuration": 60 }
  // fitness: { "trainingTypes": ["–°–∏–ª–æ–≤—ã–µ", "–ö—Ä–æ—Å—Å—Ñ–∏—Ç"], "sessionFormats": ["personal", "group"], "gymLocation": "FitnessPark, –ú–æ—Å–∫–≤–∞", "achievements": ["–ö–ú–° –ø–æ –ø–∞—É—ç—Ä–ª–∏—Ñ—Ç–∏–Ω–≥—É"] }
  // nutrition: { "approaches": ["–ö–ë–ñ–£", "–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ"], "specializations": ["–ü–æ—Ö—É–¥–µ–Ω–∏–µ", "–ù–∞–±–æ—Ä –º–∞—Å—Å—ã"], "programDuration": "1-3 –º–µ—Å—è—Ü–∞" }
  
  // –°–≤—è–∑–∏
  education       Education[]
  certificates    Certificate[]
  gallery         GalleryItem[]
  faqs            FAQ[]
  consultationRequests ConsultationRequest[]
  
  // –ú–µ–¥–∏–∞
  videoUrl        String?                   // YouTube/Vimeo URL –¥–ª—è –≤–∏–¥–µ–æ-–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏
  
  // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç—É—Å
  verified        Boolean  @default(false)
  verifiedAt      DateTime?
  acceptingClients Boolean @default(true)
  
  // SEO
  metaTitle       String?
  metaDescription String?
  
  // –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è
  subscriptionTier String  @default("FREE")  // FREE, PREMIUM
  
  // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (–∫–µ—à –∏–∑ Redis)
  profileViews    Int      @default(0)
  contactViews    Int      @default(0)
  
  // Timestamps
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  @@index([category])
  @@index([slug])
  @@index([verified])
}

// ========================================
// –û–ë–†–ê–ó–û–í–ê–ù–ò–ï
// ========================================

model Education {
  id            String     @id @default(cuid())
  specialistId  String
  specialist    Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
  
  institution   String                    // –í–£–ó –∏–ª–∏ —É—á–µ–±–Ω–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ
  degree        String                    // –°—Ç–µ–ø–µ–Ω—å/—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å
  year          Int                       // –ì–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è
  description   String?                   // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
  
  order         Int        @default(0)    // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  createdAt     DateTime   @default(now())
  
  @@index([specialistId])
}

// ========================================
// –°–ï–†–¢–ò–§–ò–ö–ê–¢–´
// ========================================

model Certificate {
  id            String     @id @default(cuid())
  specialistId  String
  specialist    Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
  
  title         String                    // –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
  organization  String                    // –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è, –≤—ã–¥–∞–≤—à–∞—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
  year          Int                       // –ì–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è
  fileUrl       String?                   // –°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª/—Å–∫–∞–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
  
  order         Int        @default(0)    // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  createdAt     DateTime   @default(now())
  
  @@index([specialistId])
}

// ========================================
// –ì–ê–õ–ï–†–ï–Ø (—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
// ========================================

model GalleryItem {
  id            String     @id @default(cuid())
  specialistId  String
  specialist    Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
  
  type          String                    // "photo" | "video"
  url           String                    // URL –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞
  thumbnailUrl  String?                   // URL –ø—Ä–µ–≤—å—é (–¥–ª—è –≤–∏–¥–µ–æ)
  caption       String?                   // –ü–æ–¥–ø–∏—Å—å –∫ –º–µ–¥–∏–∞
  
  order         Int        @default(0)    // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  createdAt     DateTime   @default(now())
  
  @@index([specialistId])
}

// ========================================
// FAQ
// ========================================

model FAQ {
  id            String     @id @default(cuid())
  specialistId  String
  specialist    Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
  
  question      String
  answer        String                    // –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Markdown
  
  order         Int        @default(0)    // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  createdAt     DateTime   @default(now())
  
  @@index([specialistId])
}

// ========================================
// –ó–ê–ü–†–û–°–´ –ù–ê –ö–û–ù–°–£–õ–¨–¢–ê–¶–ò–Æ
// ========================================

model ConsultationRequest {
  id            String     @id @default(cuid())
  specialistId  String
  specialist    Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)
  
  // –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞
  name          String
  contact       String                    // Email –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω
  message       String?                   // –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
  
  // –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
  status        String     @default("new") // "new" | "contacted" | "scheduled" | "declined"
  
  // Timestamps
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  
  @@index([specialistId])
  @@index([status])
}

// ========================================
// –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ö–ê–¢–ï–ì–û–†–ò–ô (–¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
// ========================================

model Category {
  id          String   @id @default(cuid())
  key         String   @unique              // "psychology", "fitness", "nutrition"
  name        String                        // "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –∏ —Ç–µ—Ä–∞–ø–∏—è"
  emoji       String                        // "üß†"
  priceLabel  String                        // "–∑–∞ —Å–µ—Å—Å–∏—é"
  order       Int      @default(0)          // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  isActive    Boolean  @default(true)       // –ê–∫—Ç–∏–≤–Ω–∞ –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
  
  fields      CategoryField[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([key])
  @@index([isActive])
}

model CategoryField {
  id          String   @id @default(cuid())
  categoryId  String
  category    Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  
  key         String                        // "methods", "worksWith"
  label       String                        // "–ú–µ—Ç–æ–¥—ã"
  icon        String                        // "üß†"
  type        String                        // "array", "string", "number", "boolean"
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—è
  required    Boolean  @default(false)      // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ª–∏ –ø–æ–ª–µ
  placeholder String?                       // –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –¥–ª—è input
  helpText    String?                       // –ü–æ–¥—Å–∫–∞–∑–∫–∞
  
  order       Int      @default(0)          // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  isActive    Boolean  @default(true)       // –ê–∫—Ç–∏–≤–Ω–æ –ª–∏ –ø–æ–ª–µ
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@unique([categoryId, key])
  @@index([categoryId])
  @@index([isActive])
}
